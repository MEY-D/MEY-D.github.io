<!DOCTYPE html>
<html class=""
id="theme-root" 
lang="en-US" 
dir="ltr">

<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
<meta name="theme-name" content="tailroad" />
<title>zero-click-ato-persian-versian | blog</title>
<meta name="description" content="">
<link rel="shortcut icon" href="/favicon.ico">
<script>
  document.documentElement.classList.toggle(
  "dark",
  localStorage.theme === "dark" ||
    (!("theme" in localStorage) && window.matchMedia("(prefers-color-scheme: dark)").matches),
);
</script><link rel="stylesheet" href="/css/main.26ffa0d33bc32cb240447910b7628fe31952afe8e8d20566d72eaafbc2f64308.css" integrity="sha256-Jv&#43;g0zvDLLJARHkQt2KP4xlSr&#43;jo0gVm1y6q&#43;8L2Qwg=" crossorigin="anonymous"></head>

<body class="flex flex-col text-gray-900 dark:text-white bg-white dark:bg-gray-900"><header class="w-full sticky top-0 z-50 bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700">
  <div class="px-4 py-2 lg:px-6">
    <div class="flex items-center justify-between ">      
      <div class="flex items-center space-x-2">
        <a href="/"  title="Meydi&#39;s Blog"  rel="home"
          class="flex items-center">
          
          <img src="/images/logo.jpg" alt="Meydi&#39;s Blog" class="h-10 max-h-10 w-auto mr-2">
          
        </a>
      </div>

      <nav class="flex flex-wrap gap-4 text-sm">
        
<nav class="flex flex-wrap gap-4 text-sm">
  
    
    
    
    

    <a href="/"
       class="flex items-center gap-2 px-4 py-2 rounded-md font-medium transition-colors duration-200
              
                text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-800
              ">
      
      <span>Home</span>
    </a>
  
    
    
    
    

    <a href="/about/"
       class="flex items-center gap-2 px-4 py-2 rounded-md font-medium transition-colors duration-200
              
                text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-800
              ">
      
      <span>About</span>
    </a>
  
</nav>
      </nav>

      <div class="flex items-center space-x-4">  
          <div class="flex items-center border border-gray-600 rounded-full px-4 py-2">
        <i data-lucide="search" class="w-5 h-5 text-gray-400 mr-2"></i>
        <input id="searchInput" type="text" placeholder="Search..." aria-label="Search Articles"
          class="bg-transparent focus:outline-none text-sm text-gray-900 dark:text-white placeholder-gray-400" />                  
        <kbd id="search-shortcut" class="ml-3 text-xs font-mono text-gray-500 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded">
        
      </kbd>
      </div>
          <button id="theme-toggle"
            class="p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200 cursor-pointer"
            aria-label="Toggle theme">
            <i id="theme-icon-light" data-lucide="sun" class="w-5 h-5 block dark:hidden"></i>
            <i id="theme-icon-dark" data-lucide="moon" class="w-5 h-5 hidden dark:block"></i>
          </button>
        </div>
    </div>    
  </div>
</header><main id="main-content" class="w-full" role="main">
    <div class="mx-auto max-w-5xl w-full py-6 px-4 sm:px-6 lg:px-8"><div class="grid grid-cols-1 lg:grid-cols-[1fr]"><section id="posts" class="space-y-2"><h1 class="text-3xl font-bold mb-2">zero-click-ato-persian-versian</h1>

<div class="flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mb-6">
  <div class="flex items-center gap-1"><i class="fas fa-clock"></i>4 Mins read
  </div>

  <div class="flex items-center gap-1">
      <i class="fas fa-calendar"></i>
      <time datetime="2025-09-06T01:55:32&#43;01:00">September 6, 2025</time>
    </div>
  

  <div class="flex items-center gap-1">
  </div>
</div><article class="prose dark:prose-invert max-w-none"><div dir="rtl"  style="font-family: Vazirmatn, Tahoma, Arial; font-size: 18px; line-height: 1.8;">
<p>سلام من 
<a href="https://x.com/mehdiparandin?s=21"
   
     target="_blank" rel="noopener noreferrer"
   >
   مهدی ام
</a> و این اولین write-up من به فارسیه.<br>
توی این مقاله می‌خوام یکی از باگ‌هام رو که تبدیل به Zero Click Account Takeover شد قدم به قدم توضیح بدم. اگه تازه‌کاری، احتمالا به کارت بیاد.</p>
<hr>
<h3 id="مقدمه">مقدمه</h3>
<p>برخلاف خیلی‌ها، وقتی یه target انتخاب می‌کنم، اول میرم سراغ بخش‌های ساده مثل Contact Us و صفحات فرعی. چرا؟ چون معمولا ساده نوشته شدن و راحت‌تر می‌شه طرز فکر developer رو خوند.<br>
البته که می‌تونی مستقیم بری سراغ بخش‌های سخت تر مثل authentication</p>
<hr>
<h3 id="unpredictable-idor">Unpredictable IDOR</h3>
<p>بعد از مدتی کار روی یه برنامه خیلی قدیمی و بزرگ، متوجه شدم یه feature قدیمی وجود داره که IDOR میخوره و می‌تونستم اسم victim رو تغییر بدم.<br>
اما مشکل این بود که ID عددی نبود؛ یه hash غیرقابل پیش‌بینی بود. همین باعث می‌شد unpredictable IDOR بشه.</p>
<p>منم مثل همیشه اینارو سریع report نمیدم.<br>
اینجا هم چند ماه وقت گذاشتم.</p>
<hr>
<h3 id="predictable-idor">Predictable IDOR</h3>
<p>یکی دو ماه اول سعی کردم یه راه پیدا کنم تا hash بقیه رو پیدا کنم یا حتی ریورسش کنم.<br>
تمام JavaScript هارو رو خوندم، همه requestها رو بررسی کردم، اما نتیجه‌ای نگرفتم.</p>
<p>تا اینکه توی یکی از ساب هاش، بخش Contact Us دیدم وقتی email و اطلاعات رو وارد می‌کنی (در حالی که login نیستی)، توی response یه cookie جدید ست می‌شه.<br>
اولین فکری که کردم این بود که شاید بشه باهاش Account Takeover بزنم.<br>
با اون cookie جاهای مختلف برنامه رو تست کردم و توی یکی از path ها دیدم email قربانی reflect می‌شه.<br>
اما توی پنلش هرچی با اون cookie تست کردم، یا login نبودم و ریدایرکت میشدم یا وقتی login میکردم و کوکی رو تست میکردم فقط اطلاعات خودم رو می‌دیدم.</p>
<p>یه ایده جدید به ذهنم رسید:<br>
گفتم شاید همون hash توی ریسپانسی که ایمیل رفلکت می‌شه، وجود داشته باشه.</p>
<p>سریع hash خودمو درآوردم و دوباره رفتم همونجا که ایمیل رفلکت میشد.<br>
توی response سرچ زدم و دیدم دقیقا همون hash رفلکت شده. به به</p>
<p>یعنی می‌تونستم hash هر ایمیلیو پیدا کنم.<br>
تا اینجای کار تونسته بودم IDOR بزنم و اسم بقیه رو تغییر بدم.<br>
ولی آیا بازم سریع باید میرفتم ریپورت بدم یا هنوز زوده؟</p>
<hr>
<h3 id="zero-click-ato">Zero click ATO</h3>
<p>ریسک کردم و ریپورت ندادم.<br>
اینجام نزدیک یه ماه گیر کردم. دائم فکر می‌کردم شاید یه جایی دولوپر اشتباه کرده باشه و اطلاعات قربانی رو بهم نشون بده.</p>
<p>حتی گجت‌هامو روی یه برگه نوشتم:</p>
<ul>
<li>Predictable IDOR</li>
<li>Cookie (victim email in contact Us)</li>
<li>Hash of victim</li>
</ul>
<p>هیچ‌کدوم جواب نمی‌داد و تقریبا داشتم بیخیال می‌شدم.</p>
<p>تا اینکه یه شب موقع دیدن دوباره Breaking Bad (لحظه مشت خوردن آقای سفید توسط هنک 😅) یه ایده به ذهنم رسید:</p>
<p>چرا وقتی لاگینم نیام و اون Predictable IDOR که ساختمو بزنم؟<br>
با ناامیدی رفتم تست کردم و فلو آخرم اینطوری شد:</p>
<ol>
<li>توی Contact Us ایمیل victim رو زدم و کوکی رو گرفتم</li>
<li>توی یه مسیر دیگه hash رو از response گرفتم</li>
<li>بعدش با اکانت خودم login کردم</li>
<li>همون hash رو با ایدور زدم</li>
<li>وقتی برگشتم توی بخش User Info وارد اکانت victim شدم 😋😋</li>
</ol>
<p>رفتم ریپورتو دادم، کریتیکال شد و بانتیمو هم گرفتم.</p>
<hr>
<p>تموم شد امیدوارم خوشتون اومده باشه.<br>
شکست‌ها و فکرهامو نوشتم که ببینید چطوری جلو رفتم و آخرش چطوری شده.</p>
<p>واقعا پاره شدم تا اینو نوشتم. حتی موقع ریپورت نوشتن سردرد گرفتم و استف برنامه ۳ بار ازم PoC ویدیو خواست تا تونست reproduce ش کنه.</p>
<p>و این بین هم چند تا XSS روش گزارش دادم.</p>
<p>این باگ ۹ سال بیشتر وجود داشته و کسی پیدا نکرده بود.</p>
<p>احتمالا مقاله بعدیم به زودی در مورد یه باگ دیگم: blind idor که باهاش تونستم Mass PII Leakage بزنم و اطلاعات نزدیک ۵۰ میلیون بیشتر آدم تو دنیا رو ببینم.<br>

<a href="https://x.com/mehdiparandin?s=21"
   
     target="_blank" rel="noopener noreferrer"
   >
   توییترمو
</a> دنبال کنید که اونجا لینکشو میذارم.</p>
</div>
</article>
<br>
<br></section></div>
    </div> 
</main>
  <footer class="border-t border-gray-200 dark:border-gray-700"><div class="flex flex-row text-xs text-gray-500 dark:text-gray-400 items-center px-4 lg:px-6">
  <div class="w-full">
    &copy; 2025 meydee.xyz.  All rights reserved..
    <span>Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank" class="hover:border-transparent hover:bg-purple-600 hover:text-white active:bg-purple-700">Hugo</a> and <a href="https://github.com/Sathishbs/Tailroad/" class="hover:border-transparent hover:bg-purple-600 hover:text-white active:bg-purple-700" rel="nofollow noopener" target="_blank">Tailroad</a> theme.</span>
  </div>
  <div class="flex space-x-2 ">
    
  </div>
</div>
</footer><button id="scrollTopBtn"
        class="hidden fixed bottom-6 right-6 z-50 bg-gray-800 text-white px-4 py-2 rounded-full shadow-lg hover:bg-gray-700 transition duration-300"
        aria-label="Scroll to top">
  ^
</button><script src="https://unpkg.com/lucide@latest"></script>
<script>lucide.createIcons();</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>

      <script src="/js/main.4bbde676f03a3208027a28f849d182967de5bfdd6b983f132c4cba39ee4678d0.js" integrity="sha256-S73mdvA6MggCeij4SdGCln3lv91rmD8TLEy6Oe5GeNA=" crossorigin="anonymous"></script>
      <script src="/js/theme.53c91f6a0e91fe26ae654ca710fafd7af0f4fb9d8f5c8775242b41b966437ee3.js" integrity="sha256-U8kfag6R/iauZUynEPr9evD0&#43;52PXId1JCtBuWZDfuM=" crossorigin="anonymous"></script>
      <script src="/js/toc.f0d11850d7f59e4c2f79d6672c961dae4b90ffff9b05f3ce338147675c43359c.js" integrity="sha256-8NEYUNf1nkwvedZnLJYdrkuQ//&#43;bBfPOM4FHZ1xDNZw=" crossorigin="anonymous"></script>
      <script src="/js/code.6c32af83995789313f1c9a1ba72b554e3d2b56d2046d74b32d8eb32ddbc6b400.js" integrity="sha256-bDKvg5lXiTE/HJobpytVTj0rVtIEbXSzLY6zLdvGtAA=" crossorigin="anonymous"></script>
      <script src="/js/search.db1ce50ecbf5ef971a3bfbde6ff7e11aa9ee16812aa4f047f371a1000b5dbfff.js" integrity="sha256-2xzlDsv175caO/veb/fhGqnuFoEqpPBH83GhAAtdv/8=" crossorigin="anonymous"></script></body>
</html>